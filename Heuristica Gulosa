import numpy as np

# Dados fornecidos
NC = np.array ([14,13,15,10,10,15,5,12,15,16,
                12,6,13,18,15,18,17,9,16,16,
                15,13,11,15,14,12,11,18,16,12])  # Número de clientes por ponto
dpe = np.array ([34.25,28.67,25.78,21.90,55.40,34.15,56.89,32.26,23.35,32.11,
                 37.12,61.10,32.13,37.98,32.50,32.08,22.97,29.90,26.81,36.67,
                 55.48,31.63,39.56,24.67,18.81,22.13,11.89,18.03,16.31,13.45])  # Distância dos pontos à empresa
d = np.array ([
[0.0,5.830951894845301,9.340770846134703,50.59644256269407,50.92150822589606,70.83078426785913,71.80529228406496,65.30696746902278,22.20360331117452,2.692582403567252,
17.356554957709783,49.24428900898052,52.773099207835045,53.67727638395972,52.61178575186362,2.8284271247461903,9.219544457292887,22.360679774997898,27.586228448267445,25.80697580112788,
10.295630140987,10.062305898749054,63.245553203367585,64.07027391856539,0.01,34.9857113690718,61.85466837676846,81.49846624323675,129.8345100502944,82.21921916437786],
[5.830951894845301,0.0,4.031128874149275,46.32493928760188,46.57252408878007,66.91038783328041,67.89698078707183,61.5223536610881,27.0,4.031128874149275,
 17.269916039170543,46.14108798023731,48.507731342539614,49.35838327984416,48.27007354458868,3.1622776601683795,6.4031242374328485,19.849433241279208,26.92582403567252,31.622776601683793,
 16.1245154965971,15.88238017426859,68.60029154456998,69.40461079784254,5.822379238764854,40.22437072223753,67.20119046564577,78.10249675906654,131.82184947875675,79.76214641043707],
[9.340770846134703,4.031128874149275,0.0,46.03531253288067,46.19794367718113,66.86740611089981,67.86199230791857,61.629944020743686,31.00403199585499,8.0,
 15.700318468107582,42.45291509425472,44.51123453691214,45.35416188179427,44.263416045307665,7.0178344238090995,4.5,16.650825805346713,24.62214450449026,34.73110997362451,
 19.5,19.313207915827967,70.67708256570867,71.45103218288732,9.331136050878264,42.25221887664599,69.26940161427699,78.5,135.30059127734808,80.9027193609708],
[50.59644256269407,46.32493928760188,46.03531253288067,0.0,1.0,21.0,22.0,16.278820596099706,58.89821729050889,47.90876746483883,
 61.1657583947097,73.92563831310488,67.4166151627327,67.53702688155587,66.57326790837296,48.08326112068523,50.48762224545735,58.137767414994535,68.06614430096654,73.06161783043132,
 58.60034129593445,58.148516748065035,112.71202242884297,113.6001760562016,50.593281174480076,85.0881895447306,111.36426715962351,33.734255586866,120.50311199301038,40.496913462633174],
[50.92150822589606,46.57252408878007,46.19794367718113,1.0,0.0,21.02379604162864,22.02271554554524,16.492422502470642,59.54829972383762,48.23121395942673,
 61.2474489264655,73.53910524340094,66.88796603276258,66.99440275127468,66.03786792439622,48.38388161361178,50.635955604688654,58.077534382926416,68.0294054067798,73.57309290766564,
 59.033888572581766,58.58540773947041,113.17685275708986,114.06138698087096,50.918170626997195,85.492689745966,111.8257573191436,33.95585369269929,121.45781160551181,41.048751503547585],
[70.83078426785913,66.91038783328041,66.86740611089981,21.0,21.02379604162864,0.0,1.0,5.830951894845301,76.15773105863909,68.17074152449862,
 82.12338278468563,93.60555539069249,85.90692637965812,85.87927573052768,85.0,68.4470598345904,71.34423592694787,79.1012010022604,89.05054744357274,91.7877987534291,
 78.10889834071403,77.6353656525169,131.70041761513136,132.61975720080324,70.82852603294805,104.67568963231147,130.3878828726044,13.892443989449804,115.97413504743201,25.553864678361276],
[71.80529228406496,67.89698078707183,67.86199230791857,22.0,22.02271554554524,1.0,0.0,6.708203932499369,77.02596964660685,69.14658342969665,
 83.12189843837784,94.5568612000208,86.81589716175259,86.7827747885489,85.90692637965812,69.42621983083913,72.3394774656273,80.09993757800315,90.0499861188218,92.70382947861431,
 79.05694150420949,78.58275892331599,132.61975720080324,133.5402561027947,71.8030646978247,105.62196741208714,131.30879635424276,13.038404810405298,115.84903970253703,25.059928172283335],
[65.30696746902278,61.5223536610881,61.629944020743686,16.278820596099706,16.492422502470642,5.830951894845301,6.708203932499369,0.0,70.32780389006896,62.659795722616266,
 77.01460900374681,89.88882021697692,82.76472678623425,82.80247580839597,81.88406438373708,62.96824596572466,66.12110101926616,74.33034373659252,84.2140130857092,86.00581375697809,
 72.42237223399962,71.9461604256961,125.92458060283545,126.84636376341263,65.30497760508,98.97979591815695,124.61540835707277,17.46424919657298,113.77170122662314,26.1725046566048],
[22.20360331117452,27.0,31.00403199585499,58.89821729050889,59.54829972383762,76.15773105863909,77.02596964660685,70.32780389006896,0.0,23.005434140654682,
 37.12478956169314,70.83784299369935,74.96665925596525,75.87654446533527,74.81310045707235,24.020824298928627,31.400636936215164,43.965895873961216,47.01063709417264,18.027756377319946,
 15.264337522473747,15.008331019803634,56.753854494650845,57.723478758647246,22.21351165394612,33.24154027718932,55.54277630799526,83.93449827097318,111.75866856758807,80.60397012554654],
[2.692582403567252,4.031128874149275,8.0,47.90876746483883,48.23121395942673,68.17074152449862,69.14658342969665,62.659795722616266,23.005434140654682,0.0,
 18.721645226849056,49.4191258522447,52.28049349422785,53.150729063673246,52.06966487312935,1.118033988749895,9.17877987534291,22.74313083108832,28.81405906844782,28.111385593741193,
 12.5,12.206555615733702,65.8729838401146,66.7026985960838,2.6888845270855346,37.646380968162134,64.48449426024833,78.90659034580065,129.0048448702606,79.8075810935277],
[17.356554957709783,17.269916039170543,15.700318468107582,61.1657583947097,61.2474489264655,82.12338278468563,83.12189843837784,77.01460900374681,37.12478956169314,18.721645226849056,
 0.0,34.2235299172952,40.697051490249265,41.743262929483606,40.80747480548141,17.755280904564703,11.280514172678478,9.013878188659973,10.259142264341596,32.56148031032987,
 22.005681084665387,22.192341021172147,61.4593361500106,62.09871174187111,17.34993083559701,34.04776057246644,60.05206074732157,94.03323880415903,147.03485981222275,96.59839543180829],
[49.24428900898052,46.14108798023731,42.45291509425472,73.92563831310488,73.53910524340094,93.60555539069249,94.5568612000208,89.88882021697692,70.83784299369935,49.4191258522447,
 34.2235299172952,0.0,13.038404810405298,14.0089257261219,13.892443989449804,48.30113870293329,40.24922359499622,26.92582403567252,26.0,66.18912297349165,
 56.04462507680822,56.18051263561058,87.09190547921202,87.46427842267951,49.23515106100518,63.788713735268246,85.7962703152066,107.2240644631605,177.62882648939615,114.03946685248927],
[52.773099207835045,48.507731342539614,44.51123453691214,67.4166151627327,66.88796603276258,85.90692637965812,86.81589716175259,82.76472678623425,74.96665925596525,52.28049349422785,
 40.697051490249265,13.038404810405298,0.0,1.118033988749895,1.0,51.19570294468082,43.56604182158393,32.01562118716424,34.785054261852174,73.24616030891995,
 61.1310068623117,61.1657583947097,97.94386147176351,98.38699100999075,52.76324573033771,73.08214556237385,96.60745312862771,99.74467404327912,177.341478509682,107.91200118615167],
[53.67727638395972,49.35838327984416,45.35416188179427,67.53702688155587,66.99440275127468,85.87927573052768,86.7827747885489,82.80247580839597,75.87654446533527,53.150729063673246,
 41.743262929483606,14.0089257261219,1.118033988749895,0.0,1.118033988749895,52.06966487312935,44.477522413012174,33.03407331831786,35.892199709686224,74.28492444635049,
 62.09871174187111,62.12889826803627,99.06184936694852,99.50502499874064,53.66740258294601,74.18389313051722,97.72538053136452,99.73088789337032,177.93327401023114,108.03355960070925],
[52.61178575186362,48.27007354458868,44.263416045307665,66.57326790837296,66.03786792439622,85.0,85.90692637965812,81.88406438373708,74.81310045707235,52.06966487312935,
 40.80747480548141,13.892443989449804,1.0,1.118033988749895,0.0,50.99019513592785,43.41658669218482,32.0624390837628,35.11409973215888,73.33484846919642,
 61.07372593840988,61.10032733136542,98.38699100999075,98.8382517044894,52.60190205686483,73.37574531137656,97.04638066409278,98.84331034521254,176.81911661356077,107.07007051459338],
[2.8284271247461903,3.1622776601683795,7.0178344238090995,48.08326112068523,48.38388161361178,68.4470598345904,69.42621983083913,62.96824596572466,24.020824298928627,1.118033988749895,
 17.755280904564703,48.30113870293329,51.19570294468082,52.06966487312935,50.99019513592785,0.0,8.06225774829855,21.633307652783937,27.80287754891569,28.600699292150182,
 13.038404810405298,12.776932339180638,66.03029607687671,66.85057965343307,2.8213649179076428,37.73592452822641,64.63745044476924,79.30952023559341,130.09611831257686,80.39900496896712],
[9.219544457292887,6.4031242374328485,4.5,50.48762224545735,50.635955604688654,71.34423592694787,72.3394774656273,66.12110101926616,31.400636936215164,9.17877987534291,
 11.280514172678478,40.24922359499622,43.56604182158393,44.477522413012174,43.41658669218482,8.06225774829855,0.0,13.601470508735444,20.591260281974,32.69556544854363,
 18.24828759089466,18.172781845386247,67.26812023536856,68.01470429252781,9.20978284217386,38.897300677553446,65.85590330410783,83.0,138.05795884337854,85.32877591996736],
[22.360679774997898,19.849433241279208,16.650825805346713,58.137767414994535,58.077534382926416,79.1012010022604,80.09993757800315,74.33034373659252,43.965895873961216,22.74313083108832,
 9.013878188659973,26.92582403567252,32.01562118716424,33.03407331831786,32.0624390837628,21.633307652783937,13.601470508735444,0.0,10.04987562112089,41.30375285612676,
 29.427877939124322,29.516944286290883,70.0,70.60453243241541,22.351735950480446,42.941821107167776,68.60029154456998,91.6624241442479,151.64761785138597,95.60334722173695],
[27.586228448267445,26.92582403567252,24.62214450449026,68.06614430096654,68.0294054067798,89.05054744357274,90.0499861188218,84.2140130857092,47.01063709417264,28.81405906844782,
 10.259142264341596,26.0,34.785054261852174,35.892199709686224,35.11409973215888,27.80287754891569,20.591260281974,10.04987562112089,0.0,40.311288741492746,
 31.76476034853718,32.00390601161052,63.631753079732135,64.1404708432983,27.579341906579277,38.3275357934736,62.26556030423239,101.49384217774002,157.2895419282541,105.01904589168576],
[25.80697580112788,31.622776601683793,34.73110997362451,73.06161783043132,73.57309290766564,91.7877987534291,92.70382947861431,86.00581375697809,18.027756377319946,28.111385593741193,
 32.56148031032987,66.18912297349165,73.24616030891995,74.28492444635049,73.33484846919642,28.600699292150182,32.69556544854363,41.30375285612676,40.311288741492746,0.0,
 15.620499351813308,15.945218719101975,39.92492955535426,40.85339643163099,25.815113790181133,15.297058540778355,38.62641583165593,100.57832768544127,126.03570922560003,98.15294188153507],
[10.295630140987,16.1245154965971,19.5,58.60034129593445,59.033888572581766,78.10889834071403,79.05694150420949,72.42237223399962,15.264337522473747,12.5,
 22.005681084665387,56.04462507680822,61.1310068623117,62.09871174187111,61.07372593840988,13.038404810405298,18.24828759089466,29.427877939124322,31.76476034853718,15.620499351813308,
 0.0,0.5,54.20332093147061,55.072679252057455,10.304372858160752,26.570660511172846,52.839379254491625,87.86353054595519,126.57408897558773,87.05170877128145],
[10.062305898749054,15.88238017426859,19.313207915827967,58.148516748065035,58.58540773947041,77.6353656525169,78.58275892331599,71.9461604256961,15.008331019803634,12.206555615733702,
 22.192341021172147,56.18051263561058,61.1657583947097,62.12889826803627,61.10032733136542,12.776932339180638,18.172781845386247,29.516944286290883,32.00390601161052,15.945218719101975,
 0.5,0.0,54.637441374939954,55.509008277936296,10.071251163584392,27.04163456597992,53.27522876534647,87.3741952752642,126.22301691846856,86.5520074868284],
[63.245553203367585,68.60029154456998,70.67708256570867,112.71202242884297,113.17685275708986,131.70041761513136,132.61975720080324,125.92458060283545,56.753854494650845,65.8729838401146,
 61.4593361500106,87.09190547921202,97.94386147176351,99.06184936694852,98.38699100999075,66.03029607687671,67.26812023536856,70.0,63.631753079732135,39.92492955535426,
 54.20332093147061,54.637441374939954,0.0,1.0,63.251245837532714,28.42534080710379,1.4142135623730951,140.40655255364686,149.88328792764054,137.31715115017496],
[64.07027391856539,69.40461079784254,71.45103218288732,113.6001760562016,114.06138698087096,132.61975720080324,133.5402561027947,126.84636376341263,57.723478758647246,66.7026985960838,
 62.09871174187111,87.46427842267951,98.38699100999075,99.50502499874064,98.8382517044894,66.85057965343307,68.01470429252781,70.60453243241541,64.1404708432983,40.85339643163099,
 55.072679252057455,55.509008277936296,1.0,0.0,64.07589328288759,29.206163733020468,2.23606797749979,141.35416513141735,150.7912464302885,138.2931668593933],
[0.01,5.822379238764854,9.331136050878264,50.593281174480076,50.918170626997195,70.82852603294805,71.8030646978247,65.30497760508,22.21351165394612,2.6888845270855346,
 17.34993083559701,49.23515106100518,52.76324573033771,53.66740258294601,52.60190205686483,2.8213649179076428,9.20978284217386,22.351735950480446,27.579341906579277,25.815113790181133,
 10.304372858160752,10.071251163584392,63.251245837532714,64.07589328288759,0.0,34.99085737732072,61.86032735121921,81.49736253401088,129.8421353028361,82.21994952564737],
[34.9857113690718,40.22437072223753,42.25221887664599,85.0881895447306,85.492689745966,104.67568963231147,105.62196741208714,98.97979591815695,33.24154027718932,37.646380968162134,
 34.04776057246644,63.788713735268246,73.08214556237385,74.18389313051722,73.37574531137656,37.73592452822641,38.897300677553446,42.941821107167776,38.3275357934736,15.297058540778355,
 26.570660511172846,27.04163456597992,28.42534080710379,29.206163733020468,34.99085737732072,0.0,27.018512172212592,114.23659658795863,139.84634424968,112.64102272262978],
[61.85466837676846,67.20119046564577,69.26940161427699,111.36426715962351,111.8257573191436,130.3878828726044,131.30879635424276,124.61540835707277,55.54277630799526,64.48449426024833,
 60.05206074732157,85.7962703152066,96.60745312862771,97.72538053136452,97.04638066409278,64.63745044476924,65.85590330410783,68.60029154456998,62.26556030423239,38.62641583165593,
 52.839379254491625,53.27522876534647,1.4142135623730951,2.23606797749979,61.86032735121921,27.018512172212592,0.0,139.1402170474087,149.40214188558343,136.12494260788506],
[81.49846624323675,78.10249675906654,78.5,33.734255586866,33.95585369269929,13.892443989449804,13.038404810405298,17.46424919657298,83.93449827097318,78.90659034580065,
 94.03323880415903,107.2240644631605,99.74467404327912,99.73088789337032,98.84331034521254,79.30952023559341,83.0,91.6624241442479,101.49384217774002,100.57832768544127,
 87.86353054595519,87.3741952752642,140.40655255364686,141.35416513141735,81.49736253401088,114.23659658795863,139.1402170474087,0.0,108.04165863221463,15.033296378372908],
[129.8345100502944,131.82184947875675,135.30059127734808,120.50311199301038,121.45781160551181,115.97413504743201,115.84903970253703,113.77170122662314,111.75866856758807,129.0048448702606,
 147.03485981222275,177.62882648939615,177.341478509682,177.93327401023114,176.81911661356077,130.09611831257686,138.05795884337854,151.64761785138597,157.2895419282541,126.03570922560003,
 126.57408897558773,126.22301691846856,149.88328792764054,150.7912464302885,129.8421353028361,139.84634424968,149.40214188558343,108.04165863221463,0.0,93.02150289046077],
[82.21921916437786,79.76214641043707,80.9027193609708,40.496913462633174,41.048751503547585,25.553864678361276,25.059928172283335,26.1725046566048,80.60397012554654,79.8075810935277,
 96.59839543180829,114.03946685248927,107.91200118615167,108.03355960070925,107.07007051459338,80.39900496896712,85.32877591996736,95.60334722173695,105.01904589168576,98.15294188153507,
 87.05170877128145,86.5520074868284,137.31715115017496,138.2931668593933,82.21994952564737,112.64102272262978,136.12494260788506,15.033296378372908,93.02150289046077,0.0]
]) # Matriz de distância entre os pontos

# Definindo constantes e variáveis do problema
capacidade_onibus1 = 48
capacidade_onibus2 = 16
max_onibus1 = 10
max_onibus2 = 30
custo_fixo_onibus1 = 1500
custo_km_onibus1 = 3.20
custo_fixo_onibus2 = 4000
custo_km_onibus2 = 2.90

def calcular_custo(total_onibus1, total_onibus2, km_onibus1, km_onibus2):
    return (total_onibus1 * custo_fixo_onibus1 + (km_onibus1 * custo_km_onibus1*2*28) +
            total_onibus2 * custo_fixo_onibus2 + (km_onibus2 * custo_km_onibus2*2*28))

def solucao_gulosa():
    pontos_atendidos = set()
    total_onibus1 = total_onibus2 = km_onibus1 = km_onibus2 = 0

    # Pré-alocar um ônibus de cada tipo
    onibus_pre_alocados = [1, 2]

    for onibus in onibus_pre_alocados:
        empregados_no_onibus = 0
        distancia_rota = 0
        rota = []

        while (empregados_no_onibus < capacidade_onibus1 and onibus == 1) or (empregados_no_onibus < capacidade_onibus2 and onibus == 2):
            # Escolhe o próximo ponto baseado na proximidade e capacidade disponível
            ponto_atual = None
            if rota:
                ponto_atual = min(
                    set(range(30)) - pontos_atendidos,
                    key=lambda x: d[rota[-1]][x] if NC[x] <= (capacidade_onibus1 - empregados_no_onibus if onibus == 1 else capacidade_onibus2 - empregados_no_onibus) else float('inf')
                )
            else:
                ponto_atual = max(range(30), key=lambda x: dpe[x] if x not in pontos_atendidos else -1)

            if ponto_atual is None:
                break

            pontos_atendidos.add(ponto_atual)
            empregados_no_onibus += NC[ponto_atual]
            if rota:
                distancia_rota += d[rota[-1]][ponto_atual]
            else:
                distancia_rota += dpe[ponto_atual]
            rota.append(ponto_atual)

        # Retorna para a empresa
        if rota:
            distancia_rota += dpe[rota[-1]]

        # Adiciona a distância ao ônibus apropriado
        if onibus == 1:
            total_onibus1 += 1
            km_onibus1 += distancia_rota
        else:
            total_onibus2 += 1
            km_onibus2 += distancia_rota

    while empregados_no_onibus < (capacidade_onibus1 if total_onibus1 < max_onibus1 else capacidade_onibus2) and len(pontos_atendidos) < 30:
            # Escolhe o próximo ponto baseado na proximidade e capacidade disponível
            ponto_atual = None
            if rota:
                ponto_atual = min(
                    set(range(30)) - pontos_atendidos,
                    key=lambda x: d[rota[-1]][x] if NC[x] <= (capacidade_onibus1 - empregados_no_onibus if total_onibus1 < max_onibus1 else capacidade_onibus2 - empregados_no_onibus) else float('inf')
                )
            else:
                ponto_atual = max(range(30), key=lambda x: dpe[x] if x not in pontos_atendidos else -1)

            if ponto_atual is None:
                break

            pontos_atendidos.add(ponto_atual)
            empregados_no_onibus += NC[ponto_atual]
            if rota:
                distancia_rota += d[rota[-1]][ponto_atual]
            else:
                distancia_rota += dpe[ponto_atual]
            rota.append(ponto_atual)

        # Retorna para a empresa
            if rota:
              distancia_rota += dpe[rota[-1]]

        # Decide qual ônibus será utilizado para essa rota
            if empregados_no_onibus > capacidade_onibus2 and total_onibus1 < max_onibus1:
              total_onibus1 += 1
              km_onibus1 += distancia_rota
            else:
              total_onibus2 += 1
              km_onibus2 += distancia_rota

    custo = calcular_custo(total_onibus1, total_onibus2, km_onibus1, km_onibus2)
    return custo, total_onibus1, total_onibus2, km_onibus1, km_onibus2
   
print(f'Custo total: R${custo:,.2f}')
print(f'Total ônibus 1: {total_onibus1}, km rodados: {km_onibus1:,.2f}')
print(f'Total ônibus 2: {total_onibus2}, km rodados: {km_onibus2:,.2f}')
